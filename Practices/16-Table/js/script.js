var singer=[

{
	image:"vy1",
	name:"VY1",
	sex:"Female",
	developer:"Yamaha Corporation",
	language:"Japanese",
	voice:"Unknown"
},

{
	image:"diva",
	name:"Cyber Diva",
	sex:"Female",
	developer:"Yamaha Corporation",
	language:"English",
	voice:"Jenny Shima"
},

{
	image:"yuzuki",
	name:"Yuzuki Yukari",
	sex:"Female",
	developer:"AH-Software",
	language:"Japanese",
	voice:"Chihiro Ishiguro"
},


{
	image:"luka",
	name:"Megurine Luka",
	sex:"Female",
	developer:"Crypton Future Media",
	language:"English <br/>& Japanese",
	voice:"Yū Asakawa"
},

{
	image:"gakupo",
	name:"Gackpoid",
	sex:"Male",
	developer:"Internet Co. Ltd.",
	language:"Japanese",
	voice:"Gackt"
},

{
	image:"miki",
	name:"Miki",
	sex:"Female",
	developer:"AH-Software",
	language:"Japanese",
	voice:"Miki Furukawa"
},

{
	image:"nekomura",
	name:"Nekomura Iroha",
	sex:"Female",
	developer:"AH-Software",
	language:"Japanese",
	voice:"Kyounosuke Yoshitate"
},

{
	image:"flower",
	name:"Flower",
	sex:"Female",
	developer:"Gynoid Co., Ltd. <br/>& Yamaha Corporation",
	language:"Japanese",
	voice:"Unknown"
},

{
	image:"sachiko",
	name:"Sachiko",
	sex:"Female",
	developer:"Yamaha Corporation",
	language:"Japanese",
	voice:"Sachiko Kobayashi"
},

{
	image:"arsloid",
	name:"Arsloid",
	sex:"Male",
	developer:"Universal Music Japan <br/>& Yamaha Corporation",
	language:"Japanese",
	voice:"Akira Kano"
},

{
	image:"ruby",
	name:"Ruby",
	sex:"Female",
	developer:"VocaTone/PowerFX",
	language:"English",
	voice:"Mishakeet"
},

{
	image:"kaai",
	name:"Kaai Yuki",
	sex:"Female",
	developer:"AH-Software",
	language:"Japanese",
	voice:"Unknown"
},

{
	image:"hiyama",
	name:"Hiyama Kiyoteru",
	sex:"Male",
	developer:"AH-Software",
	language:"Japanese",
	voice:"Kiyoshi Hiyama"
},

{
	image:"megpoid",
	name:"Megpoid",
	sex:"Female",
	developer:"Internet Co. Ltd.",
	language:"Japanese",
	voice:"Megumi Nakajima"
},

{
	image:"dex",
	name:"Dex",
	sex:"Male",
	developer:"Zero-G",
	language:"English",
	voice:"Sam Blakeslee"
},

{
	image:"daina",
	name:"Daina",
	sex:"Female",
	developer:"Zero-G",
	language:"English",
	voice:"Aki Glancy"
},

{
	image:"rana",
	name:"Rana",
	sex:"Female",
	developer:"We've Inc.",
	language:"Japanese",
	voice:"Ai Kakuma"
},

{
	image:"rin",
	name:"Rin",
	sex:"Female",
	developer:"Crypton Future Media",
	language:"English <br/>& Japanese",
	voice:"Asami Shimoda"
},

{
	image:"len",
	name:"Len",
	sex:"Male",
	developer:"Crypton Future Media",
	language:"English <br/>& Japanese",
	voice:"Asami Shimoda"
},

{
	image:"unity",
	name:"Unity",
	sex:"Female",
	developer:"Unity Technologies Japan <br/>& Yamaha Corporation",
	language:"Japanese",
	voice:"Asuka Kakumoto"
},

{
	image:"fukase",
	name:"Fukase",
	sex:"Male",
	developer:"Yamaha Corporation",
	language:"English <br/>& Japanese",
	voice:"Satoshi Fukase"
},

{
	image:"xingchen",
	name:"Xingchen",
	sex:"Female",
	developer:"Beijing Photek S&T <br/>& Shanghai Henian",
	language:"Chinese",
	voice:"Chalili"
},

{
	image:"otomachi",
	name:"Otomachi Una",
	sex:"Female",
	developer:"Internet Co., Ltd <br/>& MTK",
	language:"Japanese",
	voice:"Aimi Tanaka"
},

{
	image:"miku",
	name:"Hatsune Miku",
	sex:"Female",
	developer:"Crypton Future Media",
	language:"Chinese, English <br/>& Japanese",
	voice:"Saki Fujita"
},

{
	image:"tohoku",
	name:"Tohoku Zunko",
	sex:"Female",
	developer:"AH-Software",
	language:"Japanese",
	voice:"Satomi Sato"
},

{
	image:"songman",
	name:"Cyber Songman",
	sex:"Male",
	developer:"Yamaha Corporation",
	language:"English",
	voice:"Unknown"
},

{
	image:"macne",
	name:"Macne Nana",
	sex:"Female",
	developer:"MI7",
	language:"English <br/>& Japanese",
	voice:"Haruna Ikezawa"
},

{
	image:"uni",
	name:"Uni",
	sex:"Female",
	developer:"ST Media",
	language:"Korean",
	voice:"Unknown"
},

{
	image:"tone",
	name:"Tone Rion",
	sex:"Female",
	developer:"Dear Stage (Moe Japan)",
	language:"Japanese",
	voice:"Nemu Yumemi"
},

{
	image:"yumemi",
	name:"Yumemi Nemu",
	sex:"Female",
	developer:"Dear Stage (Moe Japan)",
	language:"Japanese",
	voice:"Nemu Yumemi"
},

{
	image:"yuezheng",
	name:"Yuezheng Longya",
	sex:"Male",
	developer:"Shanghai Henian",
	language:"Chinese",
	voice:"Jie Zhang"
},

{
	image:"azuki",
	name:"Azuki",
	sex:"Female",
	developer:"Sega <br/>& Yamaha Corporation",
	language:"Japanese",
	voice:"Yuka Ōtsubo"
},

{
	image:"matcha",
	name:"Matcha",
	sex:"Female",
	developer:"Sega <br/>& Yamaha Corporation",
	language:"Japanese",
	voice:"Ayaka Ohashi"
},

{
	image:"lumi",
	name:"Lumi",
	sex:"Female",
	developer:"Akatsuki Virtual Artists",
	language:"Japanese",
	voice:"Sayaka Ohara"
},

{
	image:"xinhua",
	name:"Xin Hua",
	sex:"Female",
	developer:"Gynoid Co., Ltd. <br/>& Shanghai Wangcheng",
	language:"Chinese <br/>& Japanese",
	voice:"Wenyi Wang"
},

{
	image:"luo",
	name:"Luo Tianyi",
	sex:"Female",
	developer:"Shanghai Henian",
	language:"Chinese <br/>& Japanese",
	voice:"Shan Xin"
},

{
	image:"kizuna",
	name:"Kizuna Akari",
	sex:"Female",
	developer:"AH-Software",
	language:"Japanese",
	voice:"Madoka Yonezawa"
},

{
	image:"mirai",
	name:"Mirai Komachi",
	sex:"Female",
	developer:"Bandai Namco Studio, Inc <br/>& Yamaha Corporation",
	language:"Japanese",
	voice:"Unknown"
},

{
	image:"zhiyu",
	name:"Zhiyu Moke",
	sex:"Male",
	developer:"Shanghai Henian",
	language:"Chinese",
	voice:"Shangqing Su"
},

{
	image:"moqingxian",
	name:"Mo Qingxian",
	sex:"Female",
	developer:"Shanghai Henian",
	language:"Chinese",
	voice:"Mingyue"
},

]

var audio=["vy1", "diva", "yuzuki", "luka", "gakupo", "miki", "nekomura", "flower", "sachiko", "arsloid", "ruby", "kaai", "hiyama",
		"megpoid", "dex", "daina", "rana", "rin", "len", "unity", "fukase", "xingchen", "otomachi", "miku", "tohoku", "songman", "macne",
		"uni", "tone", "yumemi", "yuezheng", "azuki", "matcha", "lumi", "xinhua", "luo", "kizuna", "mirai", "zhiyu", "moqingxian"];



for (var i=0; i<singer.length; i++) {
	$('tbody').append('<tr onmouseenter="$(\'#hover\')[0].play()" onmouseout="$(\'#hover\')[0].pause();$(\'#hover\')[0].currentTime=0">'+
			'<td class="image"><img src="img/'+singer[i].image+'.png" alt="Singer '+(i+1)+'" onmouseenter="choose(\''+audio[i]+'\')" onmouseout="cancel(\''+audio[i]+'\')"></td>'+
			'<td>'+singer[i].name+'</td>'+
			'<td>'+singer[i].sex+'</td>'+
			'<td>'+singer[i].developer+'</td>'+
			'<td>'+singer[i].language+'</td>'+
			'<td>'+singer[i].voice+'</td>'+
		'</tr>');

	$('.audio').append('<audio id="' + audio[i] +'" src="sound/' + audio[i] +'.mp3" type="audio/mpeg" loop></audio>');

	// $('\"#'+audio[i]+'\"').mouseenter(function() {
	// 	myAudio = $('\"#'+audio[i]+'\"')[0];
	// });
}

$('th').click(function() {
	$('#click')[0].play();
});

function sortTable(n) {
  var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
  table = document.getElementById("table");
  switching = true;
  //Set the sorting direction to ascending:
  dir = "asc"; 
  rows = table.rows;
  /*Make a loop that will continue until
  no switching has been done:*/
  for (var i = 1; i < table.rows[0].getElementsByTagName("TH").length; i++) {
	  rows[0].getElementsByTagName("TH")[i].querySelector('i').classList.remove("fa-sort-up");
	  rows[0].getElementsByTagName("TH")[i].querySelector('i').classList.remove("fa-sort-down");
	  rows[0].getElementsByTagName("TH")[i].querySelector('i').classList.add("fa-sort");
  }
  while (switching) {
    //start by saying: no switching is done:
    switching = false;
    
    /*Loop through all table rows (except the
    first, which contains table headers):*/
    for (i = 1; i < (rows.length - 1); i++) {
      //start by saying there should be no switching:
      shouldSwitch = false;
      /*Get the two elements you want to compare,
      one from current row and one from the next:*/
      x = rows[i].getElementsByTagName("TD")[n];
      y = rows[i + 1].getElementsByTagName("TD")[n];
      /*check if the two rows should switch place,
      based on the direction, asc or desc:*/
      if (dir == "asc") {
        if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
          //if so, mark as a switch and break the loop:
          shouldSwitch= true;
          rows[0].getElementsByTagName("TH")[n].querySelector('i').classList.remove("fa-sort");
          rows[0].getElementsByTagName("TH")[n].querySelector('i').classList.add("fa-sort-up");
          break;
        }
      } else if (dir == "desc") {
        if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
          //if so, mark as a switch and break the loop:
          shouldSwitch = true;
          rows[0].getElementsByTagName("TH")[n].querySelector('i').classList.remove("fa-sort");
          rows[0].getElementsByTagName("TH")[n].querySelector('i').classList.remove("fa-sort-up");
          rows[0].getElementsByTagName("TH")[n].querySelector('i').classList.add("fa-sort-down");
          break;
        }
      }
    }
    if (shouldSwitch) {
      /*If a switch has been marked, make the switch
      and mark that a switch has been done:*/
      rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
      switching = true;
      //Each time a switch is done, increase this count by 1:
      switchcount ++;      
    } else {
      /*If no switching has been done AND the direction is "asc",
      set the direction to "desc" and run the while loop again.*/
      if (switchcount == 0 && dir == "asc") {
        dir = "desc";
        switching = true;
      }
    }
  }
}





window.onload = function() {

var myAudio = $('#background')[0];
$('#background')[0].play();
var context = new (window.AudioContext || window.webkitAudioContext)();
var src = context.createMediaElementSource(myAudio);
var analyser = context.createAnalyser();

var canvas = document.getElementById("canvas");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight/3;
var ctx = canvas.getContext("2d");

    src.connect(analyser);
    analyser.connect(context.destination);

    analyser.fftSize = 1024;

var bufferLength = analyser.frequencyBinCount;
    console.log(bufferLength);

var dataArray = new Uint8Array(bufferLength);

var WIDTH = canvas.width;
var HEIGHT = canvas.height;

var barWidth = (WIDTH / bufferLength) * 5;
var barHeight;
var x = 0;

function renderFrame() {
    requestAnimationFrame(renderFrame);
    x = 0;

    analyser.getByteFrequencyData(dataArray);

    ctx.fillStyle = "#000";
    ctx.fillRect(0, 0, WIDTH, HEIGHT);

    for (var i = 0; i < bufferLength; i++) {
	    barHeight = dataArray[i];
	        
        var r = barHeight + (25 * (i/bufferLength));
        var g = 250 * (i/bufferLength);
        var b = 50;

        ctx.fillStyle = "rgb(" + r + "," + g + "," + b + ")";
        ctx.fillRect(x, HEIGHT - barHeight, barWidth, barHeight);

        x += barWidth + 1;
      }
}
	renderFrame();

};


function choose(choice) {
	document.getElementById(choice).play();
	$('#background')[0].pause();
}

function cancel(choice) {
	document.getElementById(choice).pause();
	document.getElementById(choice).currentTime=0;
	$('#background')[0].play();
}